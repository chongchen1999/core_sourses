Unix I/O（Input/Output）是Unix操作系统中用于处理输入和输出的机制，是Unix系统设计的核心部分之一。它提供了一套简单而强大的接口，用于对文件、设备和其他I/O资源进行读写操作。下面是对Unix I/O的详细介绍：

---

## 一、基本概念

### 1. 一切皆文件（Everything is a File）

Unix哲学中的核心思想是“一切皆文件”，包括：

* 普通文件（如文本文件）
* 目录（其实是一个包含其他文件名的文件）
* 设备文件（如 `/dev/sda`，表示硬盘）
* 管道和套接字（用于进程间通信）

### 2. 文件描述符（File Descriptor）

每个打开的文件在Unix中都由一个非负整数标识，称为**文件描述符（FD）**：

* 0：标准输入（stdin）
* 1：标准输出（stdout）
* 2：标准错误（stderr）

每个进程在启动时默认打开这三个文件描述符。

---

## 二、Unix I/O 系统调用

Unix提供了一组底层系统调用来进行I/O操作（以C语言为例）：

### 1. `open()`

打开一个文件，并返回一个文件描述符。

```c
int fd = open("file.txt", O_RDONLY);
```

### 2. `read()`

从文件中读取数据。

```c
ssize_t n = read(fd, buffer, sizeof(buffer));
```

### 3. `write()`

向文件中写入数据。

```c
ssize_t n = write(fd, buffer, nbytes);
```

### 4. `close()`

关闭文件描述符，释放资源。

```c
close(fd);
```

### 5. 其他常用系统调用：

* `lseek()`：改变文件读写位置
* `dup()` 和 `dup2()`：复制文件描述符（常用于重定向）
* `pipe()`：创建管道
* `ioctl()`：设备控制接口

---

## 三、I/O 模式

### 1. 阻塞 I/O（Blocking I/O）

默认行为：读/写操作会阻塞，直到有数据或写入完成。

### 2. 非阻塞 I/O（Non-blocking I/O）

可以通过设置文件描述符为非阻塞，使读/写操作立即返回。

### 3. 多路复用 I/O（I/O Multiplexing）

如 `select()`、`poll()`、`epoll`（Linux），用于同时监听多个I/O描述符。

### 4. 异步 I/O（AIO）

操作系统通知程序I/O已完成，不需要轮询。

---

## 四、与标准库 I/O 的区别

Unix I/O 是 **低级别、无缓冲** 的，而 C 标准库提供了 **高级别、有缓冲** 的 stdio，如 `fopen()`, `fread()`, `fprintf()` 等。这些库函数在内部通常还是通过Unix I/O系统调用来实现的。

---

## 五、优点与应用

### 优点：

* 简洁统一的接口
* 强大的组合性（如重定向、管道）
* 易于跨平台（POSIX标准）

### 应用场景：

* 系统编程（操作文件和设备）
* 网络编程（基于 socket 的通信）
* 后台守护进程（控制输入输出流）
* 高性能服务器（结合 epoll）

---
